{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@tohsakarat/table-of-content/webpack/bootstrap","webpack://@tohsakarat/table-of-content/webpack/runtime/compat get default export","webpack://@tohsakarat/table-of-content/webpack/runtime/define property getters","webpack://@tohsakarat/table-of-content/webpack/runtime/hasOwnProperty shorthand","webpack://@tohsakarat/table-of-content/webpack/runtime/make namespace object","webpack://@tohsakarat/table-of-content/external root \"flarum.core.compat['forum/app']\"","webpack://@tohsakarat/table-of-content/external root \"flarum.core.compat['common/extend']\"","webpack://@tohsakarat/table-of-content/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@tohsakarat/table-of-content/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@tohsakarat/table-of-content/external root \"flarum.core.compat['forum/resolvers/DiscussionPageResolver']\"","webpack://@tohsakarat/table-of-content/external root \"flarum.core.compat['forum/components/PostStreamScrubber']\"","webpack://@tohsakarat/table-of-content/external root \"flarum.core.compat['forum/components/PostStream']\"","webpack://@tohsakarat/table-of-content/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/resolvers/DiscussionPageResolver'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/PostStreamScrubber'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/PostStream'];","import app from 'flarum/forum/app';\nimport  { extend, override } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\nimport DiscussionPageResolver from 'flarum/forum/resolvers/DiscussionPageResolver';\nimport PostStreamScrubber from 'flarum/forum/components/PostStreamScrubber';\nimport PostStream from 'flarum/forum/components/PostStream';\n\napp.initializers.add('table-of-content', () => {\n\n\n        if(!window.copyTextToClipboard)window.copyTextToClipboard=function(text) {\n            let fallbackCopyTextToClipboard = (text) => {\n              var textArea = document.createElement('textarea');\n              textArea.value = text;\n            \n              // Avoid scrolling to bottom\n              textArea.style.top = '0';\n              textArea.style.left = '0';\n              textArea.style.position = 'fixed';\n            \n              document.body.appendChild(textArea);\n              textArea.focus();\n              textArea.select();\n            \n              document.execCommand('copy');\n            \n              document.body.removeChild(textArea);\n            };\n            if (!navigator.clipboard) {\n                fallbackCopyTextToClipboard(text);\n                return;\n            }\n            navigator.clipboard.writeText(text).then(function() {\n                alert(app.translator.trans('tohsakarat-table-of-content.forum.settings.copied')+text);\n            }, function(err) {\n                alert('tohsakarat-table-of-content.forum.settings.copyfailed '+text);\n            });\n        }\n       \n  extend(CommentPost.prototype, 'refreshContent', function () {\n      if(!document.querySelector('.PostStream') )return;\n    //console.log(this);\n    let clearPunctuation=(str)=>{;\n      let reg=new RegExp( /[\\x21-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7B-\\x7F]/)\n      return str.replace( reg ,'-').replaceAll(' ','-');\n  }\n\n //这一段母的是把页面内指向同一个discussion的链接改为跳转到楼层，这样就不用重载整个页面\n  let inPageLink=Array.prototype.slice.call(this.element.querySelectorAll('.Post-body a'))\n  \n     inPageLink.forEach((e)=>{\n      let curDiscussionRoute=window.location.href.replace(\"https://\",'').split('/').splice(0,3).join('/');\n      if(e.href.indexOf(curDiscussionRoute)!=-1)e.onclick=(w)=>{\n        //如果链接指向的是当前页面的同一个discussion，就不要重载页面了\n        let goTo=e.href.split('/')[5].split('#')[0];\n        console.log('点击了链接,即将前往楼层'+goTo);\n        w.preventDefault();  \n        if(window.location.href.split('/')[5].split('#')[0]==goTo){\n          //如果和当前所在楼层相同，就不要滚动了\n          console.log('当前所在楼层和目标楼层相同，不滚动');\n          window.location.hash  =  '#'+ e.href.split('#')[1];\n        return;}\n        app.current.data.stream.goToNumber(goTo).then(()=>{\n                console.log('goto完毕');\n              \n    \t\t  if(e.href.split('/')[5])setTimeout(\n    \t\t  ()=>{\n    \t\t      //多延迟下放图片加载下\n                    window.location.hash  =  '#'+ e.href.split('#')[1];\n                    setTimeout(()=>{ m.redraw();\n                     setTimeout(\n                         //再尝试一次，以防万一\n                         ()=>{\n                              window.location.hash  =  '#'+ e.href.split('#')[1];\n                         },500\n                    )\n                        \n                        \n                    },100)\n    \t\t  },500)}\n      \t)\n      return false;\n      \n      }\n    \n    \n    })\n \n \n //这一段开始，是生成目录\n\n //先把所有标题找出来\n  let elements1=Array.prototype.slice.call(this.element.querySelectorAll('.Post-body :is(h1, h2, h3, h4, h5, h6,.div-anchor):not([data-id])'))\n  if(!elements1.length)return;\n  elements1.forEach((e,i)=>{\n    //这一段是给标题加上锚点，以及给锚点加上id\n    //不直让标题本身作为滚动id是因为，这样不会让标题本身滚动到屏幕中间，而是顶部\n    let anchor=e\n    while(1){\n      anchor = anchor.parentNode\n      if(anchor.dataset.number)break\n    }\n    \n    \n    e.innerHTML='<span class=\"title-anchor\"></span>'+ '<span class=\"title-sub-anchor\">'+ e.innerHTML+'</span>'; \n  //加个点击引导\n    let icon = document.createElement('i');\n    icon.className='icon fas fa-up-right-from-square Button-icon';\n    e.appendChild(icon);\n    e.dataset.id=   anchor.dataset.number+'-'+clearPunctuation(e.innerText)+'-'+(elements1.map(k=>clearPunctuation(k.innerText)).filter(b=>b==clearPunctuation(e.innerText)).length==1?'':i);\n    \n    e.dataset.id= e.dataset.id.length > 10 ? e.dataset.id.substring(0, 10) : e.dataset.id\n    e.dataset.id=encodeURI(e.dataset.id)\n\n    e.className+=' title-has-anchor';\n    e.querySelector('.title-anchor').id = e.dataset.id;\n    e.querySelector('.title-sub-anchor').id = e.dataset.id;\n   \n  })\n\n  //这一段是生成目录\n  this.catalog={}\n  this.catalog.id=this.attrs.post.data.id\n  app.current.data.stream.posts().find(u=>u?.data?.id== this.catalog.id).catalog=this.catalog\n  //把目录加到stream数据模型对应的post里面去\n  \n  this.catalog.elements=elements1\n\n  this.catalog.content=this.catalog.elements.map(\n      (e)=>{\n        //这一段是通过标题数组的数据模型，生成目录的html\n        let isAnchor=Array(e.classList).map(e=>e.value).indexOf('sub-anchor')!=-1\n        let id=isAnchor? e.id : e.dataset.id\n        let link= window.location.origin+app.route.discussion(app.current.data.discussion,this.attrs.post.data.attributes.number)+'#'+id;\n        \n        e.addEventListener('click',()=>{\n            window.copyTextToClipboard('* ['+e.innerText+']('+link+')')\n        });//点击元素，复制链接\n        \n        let a=<p> <a\n        href={link}\n        target='_self'\n        data-number={this.attrs.post.data.attributes.number}\n        data-isAnchor={isAnchor}\n        data-id={id}\n        data-tag={e.tagName}\n        onclick={(u)=>{  \n\n          u.preventDefault();\n           app.current.data.stream.goToNumber(this.attrs.post.data.attributes.number).then(()=>{\n              setTimeout(()=>{\n                //console.log(a)\n              window.location.hash  =  '#'+  id;\n                \n               setTimeout(()=>{ m.redraw();},100)\n            },500)}\n            )\n            return false;\n          }\n        }\n        >{e.innerText+'\\n'}</a></p>\n\n        return a;\n      }\n      )\n      \n\n    }); \n\n\n    extend(PostStreamScrubber.prototype, 'view', function (vnode){\n      // if(app.current.data.stream.posts().filter((w)=>{return w.attributes.number==this.attrs.post.data.attributes.number})[0])app.current.data.stream.posts().filter((w)=>{return w.attributes.number==this.attrs.post.data.attributes.number})[0].catalog=this.catalog\n\n      if(!app.current)return;\n      //这一段是把滚动元素添加页面上\n        try{\n            \n            \n         if(app.current?.data?.stream?.posts().find(\n                 u=>\n                    u?.data?.id==app?.current?.data?.stream?.posts()[\n                     Math.floor(app.current.data.stream.index-app.current.data.stream.visibleStart)-1>0?Math.floor(app.current.data.stream.index-app.current.data.stream.visibleStart)-1:0]?.data?.id\n                 )?.catalog?.content.length\n             ){ \n                    vnode.children.push(\n                    <div class='catalog-icon-mobile'\n                    onclick={()=>{document.querySelector('.PostStreamScrubber.Dropdown.App-titleControl>button.Button.Dropdown-toggle:first-child').click()}}\n                    ></div>\n                    )\n            \n            }\n        \n        vnode.children.push(\n            <div class='catalog-top'>\n                {\n                    //确认到底要不要目录\n                     app.current.data.stream.progress&& app.current.data.stream.currentPostElement&&\n                    (app.current.data.stream.progress>100-app.current.data.stream.percentScreenPost||\n                    app.current.data.stream.currentPostElement.scrollHeight<window.innerHeight)\n                    ?\n                    \"\"\n                    :\n                    app?.current?.data?.stream?.posts().find(\n                    u=>u?.data?.id==app.current?.data?.stream?.posts()[Math.floor(app.current?.data?.stream?.index-app.current?.data?.stream?.visibleStart)-1>0?Math.floor(app.current?.data?.stream?.index-app.current?.data?.stream?.visibleStart)-1:0]?.data?.id)\n                   ?.catalog?.content\n                    \n                }\n    \n            </div>\n        )\n            \n            \n        }catch (e){\n            console.log(e)\n        }\n        //console.log( app.current.data.stream.posts().find(u=>u.data.id==app.current.data.stream.posts()[Math.floor(app.current.data.stream.index-app.current.data.stream.visibleStart)].data.id).catalog?.content)\n           \n       return vnode\n \n \n       })\n       \n      // m.redraw()\n  \n      override(DiscussionPageResolver.prototype, 'onmatch', function (original, args, requestedPath, route){\n        \n      //这一端是为了阻止有id时flarum原生的滚动\n      if (app.current.matches(DiscussionPage) && this.canonicalizeDiscussionSlug(args.id) === this.canonicalizeDiscussionSlug(m.route.param('id'))) {\n        // By default, the first post number of any discussion is 1\n       if(args.near!=m.route.param('near') || window.location.href.indexOf('#')==-1 )DiscussionPageResolver.scrollToPostNumber = args.near || 1;//在贴在路由不变情况下不要滚回开头\n\n      }\n      \n      \n      return this.__proto__.__proto__.onmatch.call(this, args, requestedPath, route);\n    })\n\n    override(DiscussionPageResolver.prototype, 'render', function (original, vnode){\n      if (DiscussionPageResolver.scrollToPostNumber !== null) {\n        const number = DiscussionPageResolver.scrollToPostNumber;\n        // Scroll after a timeout to avoid clashes with the render.\n        \n       if(DiscussionPageResolver.scrollToPostNumber!=m.route.param('near')|| window.location.href.indexOf('#')==-1 ) setTimeout(() => app.current.get('stream').goToNumber(number));//在贴在路由不变情况下不要滚回开头\n        \n  \n        DiscussionPageResolver.scrollToPostNumber = null;\n      }\n  \n      return this.__proto__.__proto__.render.call(this,vnode);\n    })\n\n\n\n\n     extend(DiscussionPage.prototype, 'show', function (discussion){\n         \n         if(window.location.href.indexOf('#')!=-1 && window.location.href.split('#').length==2){\n            let hash= window.location.hash;\n          setTimeout(()=>{\n          window.location.hash  =   hash;\n          },250)\n          setTimeout(()=>{\n          window.location.hash  =   hash;\n          },500)\n          }\n         \n         \n     })\n\n    override(DiscussionPage.prototype, 'render', function (original,discussion){\n          app.history.push('discussion', discussion.title());\n          app.setTitle(discussion.title());\n          app.setTitleCount(0);\n          console.log('DiscussionPage-overide')\n          // When the API responds with a discussion, it will also include a number of\n          // posts. Some of these posts are included because they are on the first\n          // page of posts we want to display (determined by the `near` parameter) –\n          // others may be included because due to other relationships introduced by\n          // extensions. We need to distinguish the two so we don't end up displaying\n          // the wrong posts. We do so by filtering out the posts that don't have\n          // the 'discussion' relationship linked, then sorting and splicing.\n          let includedPosts = [];\n          if (discussion.payload && discussion.payload.included) {\n            const discussionId = discussion.id();\n      \n            includedPosts = discussion.payload.included\n              .filter(\n                (record) =>\n                  record.type === 'posts' &&\n                  record.relationships &&\n                  record.relationships.discussion &&\n                  !Array.isArray(record.relationships.discussion.data) &&\n                  record.relationships.discussion.data.id === discussionId\n              )\n              // We can make this assertion because posts should be in the store,\n              // since they were in the discussion's payload.\n              .map((record) => app.store.getById('posts', record.id) )\n              .sort((a, b) => a.number() - b.number())\n              .slice(0, 20);\n          }\n      \n          // Set up the post stream for this discussion, along with the first page of\n          // posts we want to display. Tell the stream to scroll down and highlight\n          // the specific post that was routed to.\n          this.stream = new PostStreamState(discussion, includedPosts);\n          const rawNearParam = m.route.param('near');\n          const nearParam = rawNearParam === 'reply' ? 'reply' : parseInt(rawNearParam);\n        \n          this.stream.goToNumber(nearParam || (includedPosts[0]?.number() ?? 0), true).then(() => {\n            this.discussion = discussion;\n      \n            app.current.set('discussion', discussion);\n            app.current.set('stream', this.stream);\n            \n          if(window.location.href.indexOf('#')!=-1 && window.location.href.split('#').length==2){\n          let hash=window.location.href.split('#')[1]\n          \n          setTimeout(()=>{\n          window.location.hash  =   '#'+hash;\n          },300)\n          setTimeout(()=>{\n          window.location.hash  =   '#'+hash;\n          },1000)\n          }\n          \n          \n          \n          });\n      \n      \n  \n    })\n\n\n    /**\n   * When the posts that are visible in the post stream change (i.e. the user\n   * scrolls up or down), then we update the URL and mark the posts as read.\n   */\n\n    override(DiscussionPage.prototype, 'positionChanged', function(original,startNumber, endNumber){\n        const discussion = this.discussion;\n    \n        if (!discussion) return;\n    \n        // Construct a URL to this discussion with the updated position, then\n        // replace it into the window's history and our own history stack.\n        const url = app.route.discussion(discussion, (this.near = startNumber))+(window.location.hash.substr(1).split('-')[0]==this.near?window.location.hash:'');\n    \n        window.history.replaceState(null, document.title, url);\n        app.history.push('discussion', discussion.title());\n    \n        // If the user hasn't read past here before, then we'll update their read\n        // state and redraw.\n        if (app.session.user && endNumber > (discussion.lastReadPostNumber() || 0)) {\n          discussion.save({ lastReadPostNumber: endNumber });\n          m.redraw();\n        }\n  });\n  \n  \n  \n\n    //这一段开始是给帖子加进度条\n    window.updateCatalogTop=()=>{\n    if(!app?.current?.data?.stream?.index)return;\n     let footer = document.querySelector( '.PostStream-item[data-index=\"'+Math.floor(app?.current?.data?.stream?.index-1) +'\"]'+\" li.item-progress\")\n     app.current.data.stream.progress=Math.floor((app.current.data.stream.index-Math.floor(app.current.data.stream.index))*100) \n     if(!footer)return;\n     footer.innerText= Math.floor(app.current.data.stream.progress+ app.current.data.stream.percentScreenPost/3)+'%'  \n      m.redraw();\n      \n     \n     if(app.current.data.stream.progress>100-app.current.data.stream.percentScreenPost || app.current.data.stream.progress<app.current.data.stream.percentScreenPost){\n         \n        let element2=document.querySelector(\n         '.PostStreamCurrent'\n        )\n        \n        if(!element2)return\n        element2.className=element2.className.replaceAll('PostStreamCurrent','')\n     }\n     \n     \n\n    }\n\n        window.addEventListener('scroll', window.updateCatalogTop); \n        window.addEventListener('touchmove', window.updateCatalogTop); \n\n\n\n   window.updateCurrentPostClass=()=>{\n       \n         if(!app?.current?.data?.stream?.index)return;\n         \n         //自动关灯\n         let classList=document.querySelector(\".DiscussionPage-discussion\").className.split(' ');\n         \n       if(app?.current?.data?.stream?.index>1.2) {\n           \n           if(classList.indexOf('streamNotFirst')==-1)classList.push('streamNotFirst')\n       }else{\n           \n           classList=classList.filter((e)=>e!='streamNotFirst')\n       }\n       \n       document.querySelector(\".DiscussionPage-discussion\").className=classList.join(' ')\n       \n       //升级阅读进度\n         let element1=document.querySelector(\n         '.PostStream-item[data-index=\"'+Math.floor(app.current.data.stream.index-1) +'\"]'\n        )\n        \n        app.current.data.stream.percentScreenPost = (window.innerHeight-100)/element1.scrollHeight*100-2;\n        app.current.data.stream.currentPostElement=element1;\n \n        let element2=document.querySelector(\n         '.PostStreamCurrent'\n        )\n        if(element1==element2 || (!element1))return;\n        \n        \n        if(\n        element1.scrollHeight<window.innerHeight ||\n        app.current.data.stream.progress>100-app.current.data.stream.percentScreenPost || \n        app.current.data.stream.progress<app.current.data.stream.percentScreenPost\n        ){\n            \n            //不需要进度条的帖子\n            if( !element2)return;\n            \n            element2.className=element2.className.replaceAll('PostStreamCurrent','')\n            \n        }else{\n      \n        \n             element1.className+=' PostStreamCurrent'\n            if(!element2)return;\n            element2.className=element2.className.replaceAll('PostStreamCurrent','')\n        \n        }\n     }\n      window.addEventListener('scroll',window.updateCurrentPostClass); \n        window.addEventListener('touchmove', window.updateCurrentPostClass); \n        \n        \n        \n    extend(CommentPost.prototype, 'actionItems', function (items) {\n        items.add(\n          'progress',\n          \n           <span></span>\n           \n          \n          ,10\n        );\n     });\n  \n  \n\n\n  \n})\n  \n  \n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","app","window","copyTextToClipboard","text","navigator","clipboard","writeText","then","alert","err","textArea","document","createElement","style","top","left","position","body","appendChild","focus","select","execCommand","removeChild","fallbackCopyTextToClipboard","extend","CommentPost","querySelector","clearPunctuation","str","reg","RegExp","replace","replaceAll","Array","slice","this","element","querySelectorAll","forEach","e","curDiscussionRoute","location","href","split","splice","join","indexOf","onclick","w","goTo","console","log","preventDefault","hash","setTimeout","m","redraw","elements1","length","i","anchor","parentNode","dataset","number","innerHTML","icon","className","id","innerText","map","k","filter","b","substring","encodeURI","catalog","attrs","post","data","find","u","elements","content","isAnchor","classList","link","origin","attributes","addEventListener","target","tagName","PostStreamScrubber","vnode","stream","posts","Math","floor","children","push","class","click","innerHeight","index","visibleStart","override","DiscussionPageResolver","original","args","requestedPath","route","DiscussionPage","canonicalizeDiscussionSlug","param","near","__proto__","onmatch","goToNumber","render","discussion","title","includedPosts","payload","included","discussionId","record","type","relationships","isArray","sort","PostStreamState","rawNearParam","nearParam","parseInt","startNumber","endNumber","url","substr","history","replaceState","lastReadPostNumber","save","updateCatalogTop","footer","element2","updateCurrentPostClass","element1","scrollHeight","items","add"],"sourceRoot":""}